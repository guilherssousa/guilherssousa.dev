---
import Main from '@/layouts/Main.astro';

import { zenblog } from '@/lib/blog';

import type { Post } from 'zenblog/types'

export async function getStaticPaths() {
	const posts = await zenblog.posts.list();
	return posts.data.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}
type Props = Post;

const postInfo = Astro.props;

const { data: post } = await zenblog.posts.get({ slug: postInfo.slug });
---

<Main title={post.title} description={post.excerpt} image={post.cover_image}>
	<div class="prose-h1:my-0">
		<img src={post.cover_image} alt={post.title} class="w-full aspect-video object-cover rounded-lg shadow-xl" />
		<h1>{post.title}</h1>
		<div class="mt-2">{post.excerpt}</div>

		<span class="text-sm dark:text-neutral-400 text-neutral-600">
		Posted on {new Date(post.published_at).toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
		</span>
	</div>

	<div set:html={post.html_content}></div>
</Main>
